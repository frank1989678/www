<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>交通事故快速处理平台</title>
    <meta name="renderer" content="webkit" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/plugins/select2/select2.css" />
</head>
<body>

<!-- header begin -->
<div class="header cf">
	<div class="logo">
		<a href="index.html">交通事故快速处理平台</a>
	</div>
	<div class="user">
		<div class="online">在线用户数：8人</div>
		<dl>
			<dt><i class="ico ico-user"></i>系统管理员</dt>
			<dd>
				<a href="javascript:;" id="jmodifyPwd">修改密码</a>
				<a href="login.html">安全退出</a>
			</dd>
		</dl>
	</div>
</div>
<!-- header end -->

<div class="nav cf">
	<ul>
		<li><a href="index.html"><i class="ico ico-1"></i>首页</a></li>
		<li><a href="sgdz.html"><i class="ico ico-2"></i>事故定责</a></li>
		<li>
			<dl>
				<dt><i class="ico ico-3"></i>系统设置</dt>
				<dd>
					<a href="user.html">用户管理</a>
					<a href="role.html">角色管理</a>
					<a href="area.html">用户区域设置</a>
					<a href="source.html">资源管理</a>
				</dd>
			</dl>
		</li>
		<li>
			<dl>
				<dt><i class="ico ico-3"></i>报表统计</dt>
				<dd>
					<a href="statis.html">报表统计</a>
					<a href="accident-his.html">历史事故查询</a>
					<a href="accident.html">事故查询</a>
				</dd>
			</dl>
		</li>
	</ul>
</div>

<div class="wrapper">
	<div class="crumbs">
		<em>待处理事故共有 4 条</em>
	</div>

	<div class="box">
		<div class="tit">待处理事故一览 (全部区域)</div>

		<div class="operate">
			<button type="button" class="ubtn ubtn-primary">刷新</button>
		</div>

		<div class="mt15 table">
			<script id="tableTemp" type="text/html">
				{{each list as item i}}
				<tr>
					<td>{{item.id}}</td>
					<td>{{item.number}}</td>
					<td>{{item.datetime}}</td>
					<td>{{item.address}}</td>
					<td>{{item.name1}}</td>
					<td>{{item.mobile1}}</td>
					<td>{{item.name2}}</td>
					<td>{{item.mobile2}}</td>
					<td>
						<a href="sgdz-detail.html?id={{item.id}}" class="ubtn ubtn-orange">处理</a>
					</td>
				</tr>
				{{/each}}
			</script>

			<table>
				<thead>
					<tr>
						<th>序号</th>
						<th>事故编号</th>
						<th>事故报警时间</th>
						<th>事故发生地点</th>
						<th>甲姓名</th>
						<th>甲电话</th>
						<th>乙姓名</th>
						<th>乙电话</th>
						<th width="130">操作</th>
					</tr>
				</thead>
				<tbody id="tbody"></tbody>
			</table>
		</div>
		
		<div class="operate">
			<div class="pagination"></div>
		</div>
	</div>

	<div class="chart cf">
		<div class="item chart1" id="chart1"></div>
		<div class="item chart2" id="chart2">
			<ul>
				<li class="li1"><span class="a1">超过5分钟未完成定责的 <em>0</em> 条</span></li>
				<li class="li2"><span class="a2">超过10分钟未完成定责的 <em>0</em> 条</span></li>
				<li class="li3"><span class="a3">超过15分钟未完成定责的 <em>0</em> 条</span></li>
				<li class="li4"><span class="a4">超过20分钟未完成定责的 <em>0</em> 条</span></li>
			</ul>
		</div>
		<div class="item chart3" id="chart3"></div>
	</div>
</div>

<div class="footer">
	<span>湖北省宏锐慧通信息技术有限公司</span>
</div>

<!-- 公用 -->
<script src="assets/js/jquery191.js"></script>
<script src="assets/plugins/layer/layer.js"></script>
<script src="assets/js/common.js"></script>

<!-- 页面专用 -->
<script src="assets/js/art.template.js"></script>
<script src="assets/js/ajaxPage.js"></script>
<script src="assets/js/echarts.min.js"></script>

<!-- 拦截ajax请求并返回虚拟数据(只做演示使用，开发时请删除) -->
<script src="assets/js/mock.js"></script>
<script>
	Mock.mock('http://g.cn', {
		"result": "SUCCESS",
	    "totalSize": 18,
	    "list|10": [{
		    "id": "@increment",
	        "number": "W@natural",
	        "datetime": "@datetime",
	        "address": "东湖新技术开发区",
	        "name1": "@cname",
	        "mobile1": /^1[345678]\d{9}$/,
	        "name2": "@cname",
	        "mobile2": /^1[345678]\d{9}$/
		}]
	});
</script>
<!-- 拦截ajax请求并返回虚拟数据(只做演示使用，开发时请删除) end -->


<script>
var _global = {
	init: function() {
		this.filter();
		this.chart();
	},
	filter: function() {
		var that = this;
		var $form = $('#filter');
		var page =  new Page({
			pageIndex: 1, // 当前页
			pageSize: 10, // 每页显示10条
			url: 'http://g.cn',
			callback: function(res) {
				$('#tbody').empty().html(template('tableTemp', res));
			}
		})
		
		// 查询
		$form.on('submit', function() {
			var filterData = $form.serializeArray();
			page.request(true, filterData);
			return false;
		})
	},
	chart: function() {
		var timer = 0;
		var chart1 = echarts.init(document.getElementById('chart1'));
        var chart3 = echarts.init(document.getElementById('chart3'));

        var chartReset = function() {
        	clearTimeout(timer);
        	timer = setTimeout(function() {
        		chart1.resize();
        		chart3.resize();
        	}, 50)
        }
        this.chart1(chart1);
        this.chart3(chart3);

        $(window).on('resize', chartReset);
	},
	chart1: function(chart1) {
        chart1.setOption({
            tooltip : {},
            backgroundColor: '#fff',
            color:['#4778c7', '#b39ddb', '#5ecba1', '#ffc400', '#dd4038'],
            title: {
                text: '今日事故',
        		left: '10%',
        		top: 20,
        		textStyle: {
        			color: '#5a738e',
        			fontWeight: 400
        		}
            },
		    legend: {
		        orient: 'vertical',
		        top: '32.56%',
		        left: '60%',
		        itemWidth: 12,
		        itemHeight: 12,
		        itemGap: 15,
		        selectedMode: false,
		        borderRadius: 0,
		        data: ['待处理','处理中','定责完成','异常关闭','处理完成']
		    },
            series: {
                type: 'pie',
                legendHoverLink: false,
                hoverAnimation: false,
                radius: ['0', '55%'],
                center: ['28%', '58.59%'],
                label: {
                	normal: {
                		show: false
                	}
                }
            }
        });

        var data1 = {
        	total: 126,
            legendData: {
            	'待处理': 3,
            	'处理中': 0,
            	'定责完成': 102,
            	'异常关闭': 21,
            	'处理完成': 0
            },
        	seriesData: [
        		{value: 3, name: '待处理'},
            	{value: 0, name: '处理中'},
            	{value: 102, name: '定责完成'},
            	{value: 21, name: '异常关闭'},
            	{value: 0, name: '处理完成'}
            ]
        }

        chart1.setOption({
        	title: {
        		text: '今日事故：' + data1.total
        	},
        	legend: {
        		formatter: function(name, key) {
        			return name + '（' +  data1.legendData[name] + '）'
        		}
        	},
        	series: {
        		data: data1.seriesData
        	}
        })
	},
	chart3: function(chart3) {
		chart3.setOption({
            title: {
                text: '近期处理事故数',
        		left: 30,
        		top: 10,
        		textStyle: {
        			color: '#5a738e',
        			fontWeight: 400
        		}
            }
		})
		var options = {
		    tooltip: {
		        trigger: 'axis'
		    },
            backgroundColor: '#fff',
		    legend: {
		        top: 10,
		        right: 30,
		        itemWidth: 12,
		        itemHeight: 12,
		        selectedMode: false,
		        borderRadius: 0,
		        data:['处理事故数']
		    },
		    grid: {
		        left: '3%',
		        right: '4%',
		        bottom: '3%',
		        containLabel: true,
		        borderWidth: 0
		    },
		    xAxis: {
                axisLine: {
                    lineStyle: {
                    	color: '#a9c7ff',
                    	width: 2
                    }
                },
                axisLabel: {
                	textStyle: {
					    color: function (value, index) {
					        return index%2 === 0 ? '#5a738e' : '#eb9335';
					    }
					}
                },
                data: []
		    },
		    yAxis: {
                axisLine: {
                    lineStyle: {
                    	color: '#a9c7ff',
                    	width: 2
                    }
                },
                axisLabel: {
                	textStyle: {
                		color: '#5a738e'
                	}
                },
		    	scale : true,
		    	splitLine: {
		    		lineStyle: {
		    			color: '#e6ecf9'
		    		}
		    	}
		    },
            series: {
                name: '处理事故数',
                type: 'line',
                itemStyle: {
                	normal: {
                		borderWidth: 5,
                		color: '#ffa511'
                	}
                },
                lineStyle: {
                	normal: {
                		color: '#ffa511',
                		opacity: 0.53,
                		width: 3
                	}
                },
                areaStyle: {
                	normal: {
                		color: '#ffa511',
                		opacity: 0.09
                	}
                },
                data: []
            }
        }

        $.ajax({
        	url: '',
        	data: {},
        	success: function(res) {
        		res = {
        			item: ['2017\n06-01', '2017\n06-02', '2017\n06-03', '2017\n06-04', '2017\n06-05', '2017\n06-06', '2017\n06-07', '2017\n06-08', '2017\n06-09', '2017\n06-10'],
        			value: [90, 160, 130, 110, 148, 120, 150, 155, 180, 170]
        		}
		        options.xAxis.data = res.item;
		        options.series.data = res.value;
		        chart3.setOption(options);
        	}
        })
	}
}
</script>
</body>
</html>