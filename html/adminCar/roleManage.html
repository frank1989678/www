<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>角色管理</title>
    <meta name="renderer" content="webkit" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/plugins/daterangepicker.min.css" />
    <script src="assets/js/jquery191.js"></script>
</head>
<body>

<!-- header begin -->
<div class="header cf">
	<div class="logo">
		<a href="index.html">武汉119作战指挥中心调度平台</a>
	</div>
	<div class="nav">
		<ul>
			<li>
				<dl>
					<dt><i class="ico ico-1"></i>地图管控</dt>
					<dd>
						<a href="track.html">车辆监控</a>
						<a href="dispatcherManage.html">调度管理</a>
						<a href="trackHis.html">历史轨迹</a>
						<a href="railManage.html">电子围栏</a>
					</dd>
				</dl>
			</li>
			<li>
				<dl>
					<dt><i class="ico ico-2"></i>视频监控</dt>
					<dd>
						<a href="ocxClient.html">多车视频监控</a>
					</dd>
				</dl>
			</li>
			<li>
				<dl>
					<dt><i class="ico ico-3"></i>信息报表</dt>
					<dd>
						<a href="alarmHotSpot.html">警情记录</a>
						<a href="alarmRecord.html">报警记录</a>
					</dd>
				</dl>
			</li>
			<li>
				<dl>
					<dt><i class="ico ico-4"></i>系统管理</dt>
					<dd>
						<a href="carManage.html">车辆管理</a>
						<a href="orgManage.html">机构管理</a>
						<a href="userManage.html">用户管理</a>
						<a href="roleManage.html">角色管理</a>
						<a href="purviewManage.html">权限管理</a>
						<a href="contactsManage.html">通讯录管理</a>
					</dd>
				</dl>
			</li>
		</ul>
	</div>
	<div class="user">
		<span>yitop</span>
		<i>|</i>
		<a href="javascript:;" id="mdyPwd">修改密码</a>
		<i>|</i>
		<a href="javascript:;" id="mdyTheme">主题</a>
		<i>|</i>
		<a href="login.html" class="ico ico-logout"></a>
	</div>
</div>
<!-- header end -->

<div class="wrapper">

	<div class="box">
		<div class="tit">角色管理</div>

		<div class="filter">
			<button type="button" class="ubtn ubtn-primary" onclick="_add()">新增</button>
		</div>

		<div class="table">
			<table>
				<thead>
					<tr>
						<th>角色编码</th>
						<th>角色名称</th>
						<th>操作</th>
					</tr>
				</thead>
				<tbody id="tbody">
					<tr>
						<td>001</td>
						<td>值班员</td>
						<td>
							<button type="button" class="ubtn ubtn-white jpurview" onclick="_purview('001')">权限分配</button>
							<button type="button" class="ubtn ubtn-primary jedit" onclick="_edit('001')">编辑</button>
							<button type="button" class="ubtn ubtn-red jdel" onclick="_del('001')">删除</button>
						</td>
					</tr>
					<tr>
						<td>002</td>
						<td>指挥员</td>
						<td>
							<button type="button" class="ubtn ubtn-white jpurview" onclick="_purview('002')">权限分配</button>
							<button type="button" class="ubtn ubtn-primary jedit" onclick="_edit('002')">编辑</button>
							<button type="button" class="ubtn ubtn-red jdel" onclick="_del('002')">删除</button>
						</td>
					</tr>
					<tr>
						<td>003</td>
						<td>系统管理员</td>
						<td>
							<button type="button" class="ubtn ubtn-white jpurview" onclick="_purview('003')">权限分配</button>
							<button type="button" class="ubtn ubtn-primary jedit" onclick="_edit('003')">编辑</button>
							<button type="button" class="ubtn ubtn-red jdel" onclick="_del('003')">删除</button>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
</div>

<div class="footer">
    <span>湖北省宏锐慧通信息技术有限公司</span>
</div>

<!-- 新增&编辑 -->
<div class="form layer-form" id="tempForm">
	<div class="ftit">添加</div>
	<form name="form1" onsubmit="return false;">
		<div class="item">
            <div class="txt">角色编码：</div>
            <div class="cnt">
            	<input type="text" name="code" class="ipt"  />
            </div>
        </div>
		<div class="item">
            <div class="txt">角色名称：</div>
            <div class="cnt">
            	<input type="text" name="roleName" class="ipt" />
            </div>
        </div>
	    <div class="buttons">
	        <button type="button" class="ubtn ubtn-white layer-close">取消</button>
	        <button type="submit" class="ubtn ubtn-primary submit" onclick="_submitForm()">确定</button>
	    </div>
	</form>
</div>
<!-- end 新增&编辑 -->

<!-- 角色授权 -->
<div class="form layer-form" id="treeForm">
	<div class="ftit">角色授权</div>
	<ul id="ztree" class="ztree"></ul>
    <div class="buttons">
        <button type="button" class="ubtn ubtn-white layer-close">取消</button>
        <button type="button" class="ubtn ubtn-primary submit">确定</button>
    </div>
</div>
<!-- end 角色授权 -->


<!-- 公用 -->
<script src="assets/plugins/layer/layer.js"></script>
<script src="assets/js/common.js"></script>

<!-- 页面专用 -->
<script>
// 页面配置信息，必须放在listPage.js前面配合使用
var pageSetting = {
	name      : "角色", 	// 页面名称，用于提示信息
	iid       : 0, 		// 等于0时为新增，其他为编辑
	submitURL : '', 	// 提交表单（新增&编辑url地址）
	getURL    : 'http://h.cn', 	// 编辑信息时回填表单
	delURL    : '' 		// 删除一条数据
}
</script>
<script src="assets/app/listPage.js"></script>
<link rel="stylesheet" href="assets/plugins/zTreeStyle/jquery.ztree.css" />
<script src="assets/plugins/zTreeStyle/jquery.ztree.min.js"></script>

<!-- 拦截ajax请求并返回虚拟数据(只做演示使用，开发时请删除) -->
<script src="assets/js/mock.js"></script>
<script>
	Mock.mock('http://h.cn', {
		"result": "SUCCESS",
	    "data": {
	        "code": "002",
	        "roleName": "指挥员"
		}
	});
	Mock.mock('http://a.cn', {
		"result": "SUCCESS",
	    "list": [{"id":1,"pId":0,"name":"地图管控","checked":true},{"id":2,"pId":1,"name":"车辆监控","checked":false},{"id":3,"pId":1,"name":"调度管理","checked":false},{"id":4,"pId":1,"name":"历史轨迹","checked":false},{"id":5,"pId":1,"name":"电子围栏","checked":true},{"id":6,"pId":0,"name":"视频监控","checked":false},{"id":7,"pId":6,"name":"多车视频监控","checked":false},{"id":8,"pId":0,"name":"统计报表","checked":false},{"id":9,"pId":8,"name":"警情记录","checked":false},{"id":10,"pId":8,"name":"报警记录","checked":true},{"id":11,"pId":0,"name":"系统管理","checked":true},{"id":12,"pId":11,"name":"车辆管理","checked":true},{"id":13,"pId":11,"name":"机构管理","checked":true},{"id":14,"pId":11,"name":"用户管理","checked":false},{"id":15,"pId":11,"name":"角色管理","checked":false},{"id":16,"pId":11,"name":"权限管理","checked":true},{"id":17,"pId":0,"name":"修改密码","checked":true},{"id":18,"pId":0,"name":"注销","checked":true},{"id":19,"pId":0,"name":"主题"}]
	});
</script>
<!-- 拦截ajax请求并返回虚拟数据(只做演示使用，开发时请删除) end -->


<script>
function clickName(e, treeId, treeNode) {
    var zTree = $.fn.zTree.getZTreeObj('ztree');
    zTree.checkNode(treeNode, !treeNode.checked, null, true);
    return false;
}
var setting = {
    check: {
        enable: true,
        chkboxType: { "Y": "ps", "N": "ps" }
    },
    data: {
        simpleData: {
            enable: true,
            idKey: 'id',
            pIdKey: 'pid',
            rootPId: null
        }
    },
    view: {
    	showIcon: false,
        showLine: false
    },
    callback: {
        onClick: clickName
    }
};

// 权限分配
function _purview(id) {
	$.ajax({
		url: 'json/getPermission.json',
		dataType: 'json',
		success: function(res) {
			$.each(res.data, function(i, item) {
                item.open = true; // 展开节点
            })
			$.fn.zTree.init($('#ztree'), setting, res.data);
			layer.open({
				fix: false,
				area: '540px',
				offset: '50px',
				type: 1,
				title: false,
				content: $('#treeForm')
			})
		},
		error: function() {
			$.notify({
				type: 'danger',
				title: '数据加载失败!'
			})
		}
	})
}

</script>
</body>
</html>