<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>订单-上工好药</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="assets/css/app.css">
</head>
<body class="bg-gray">

<section class="ui-content">
    <div class="ui-tab">
        <ul class="cf">
            <li class="curr"><a href="?id=1">待付款</a></li>
            <li><a href="?id=2">待发货</a></li>
            <li><a href="?id=0">待收货</a></li>
        </ul>
    </div>
    <div class="ui-cnt">
        <!-- 
        <div class="ui-empty">
            <p>没有代付款的订单！</p>
            <div class="btm">
                <a href="enquiry.html" class="ubtn ubtn-red"><i class="ico ico-camera"></i> 拍照询价</a>
            </div>
        </div> 
        -->

        <ul class="olist">
            <li>
                <a href="pay.html" class="ubtn ubtn-red pay">去支付</a>
                <a href="order_detail.html">
                    <div class="hd">
                        <p><span>状态：</span><em>待支付</em></p>
                        <p><span>总价：</span>¥180.00</p>
                        <p><span>保证金：</span>¥100.00</p>
                    </div>
                    <div class="bd">
                        <span>海马、天冬、天麻、党参、煅人中白、制马钱子、海马、天冬、天麻、党参、煅人中白、制马钱子</span>
                        <em>共10个商品</em>
                    </div>
                </a>
            </li>
            <li>
                <a href="pay.html" class="ubtn ubtn-red pay">去支付</a>
                <a href="order_detail.html">
                    <div class="hd">
                        <p><span>状态：</span><em>待支付</em></p>
                        <p><span>总价：</span>¥180.00</p>
                        <p><span>保证金：</span>¥100.00</p>
                    </div>
                    <div class="bd">
                        <span>海马、天冬、天麻、党参、煅人中白、制马钱子、海马、天冬、天麻、党参、煅人中白、制马钱子</span>
                        <em>共10个商品</em>
                    </div>
                </a>
            </li>
        </ul>
    </div>


</section><!-- /ui-content -->

<script src="assets/js/jquery191.js"></script>
<script src="assets/js/app.js"></script>
<script src="assets/js/dragloader.min.js"></script>
<script>
!(function($) {
    var _global = {
        init: function() {
            this.pagesize = 0;
            this.loadmore();
            this.loading();
        },
        loading: function() {
            var that = this,
                $ul = $('.olist');

            $.ajax({
                type: 'GET',
                url: 'php/order.json',
                dataType: 'json',
                data: {pagesize: that.pagesize},
                success: function(data){
                    if (!data.list) {
                        return;
                    }
                    $ul.append(that.toHtml(data.list));
                    if (data.nomore || 15 < 6) {
                        $('body').append('<div class="nomore">没有更多了...</div>');
                        that.dragger.options.disableDragUp = true;
                    }
                    that.pagesize ++;
                },
                error: function(xhr, type){
                    popover('网络连接超时，请您稍后重试!');
                },
                complete: function() {
                    that.dragger.reset();
                }
            });
        },
        loadmore: function() {
            var that = this;

            that.dragger = new DragLoader(document.body, {
                disableDragDown: true,
                dragUpLoadFn: function() {
                    that.loading();
                }
            });
        },
        toHtml: function(data) {
            var model = [];
            var status = {
                1: "未受理",
                2: "待发货",
                3: "订单已完成"
            }
            $.each(data, function(i, item) {
                model.push('<li>');
                model.push('<a href="pay.html?id=', item.id, '" class="ubtn ubtn-red pay">去支付</a>');
                model.push('<a href="pay.html?id=', item.id, '">');
                model.push('<div class="hd">');  
                model.push('<p><span>状态：</span><em>', status[item.status], '</em></p>'); 
                model.push('<p><span>总价：</span>&yen;', item.price, '</p>'); 
                model.push('<p><span>保证金：</span>&yen;', item.price, '</p>'); 
                model.push('</div>');
                model.push('<div class="bd">');
                model.push('<span>海马、天冬、天麻、党参、煅人中白、制马钱子、海马、天冬、天麻、党参、煅人中白、制马钱子</span>');  
                model.push('<em>共10个商品</em>');
                model.push('</div>');
                model.push('</a>');
                model.push('</li>');
            })
            return model.join('');
        }
    }

    _global.init();
})(window.Zepto || window.jQuery);
</script>
</body>
</html>